id: ysoft-safeq-panel

info:
  name: YSoft SafeQ - Panel Exposure
  author: matejsmycka
  severity: info
  description: |
    YSoft SafeQ is a comprehensive print management solution used by many organizations to manage printer infrastructure. An exposed YSoft SafeQ panel may reveal sensitive organizational information and provide unauthorized access to print management capabilities.
  impact: |
    Exposed YSoft SafeQ panels can lead to unauthorized access to print management systems, potentially allowing attackers to monitor print activities, access sensitive documents, or disrupt printing services.
  remediation: |
    Ensure YSoft SafeQ panels are only accessible from internal networks or properly secured with authentication and access controls. Consider implementing VPN access for remote administration.
  reference:
    - https://www.ysoft.com/safeq
    - https://1617882505.rsc.cdn77.org/YSoft_SAFEQ_Cloud_documentation.pdf
  metadata:
    verified: true
    max-request: 2
    shodan-query:
      - title:"YSoft SafeQ"
      - title:"SafeQ&reg;"
      - http.favicon.hash:-608698287
      - http.favicon.hash:93381563
    fofa-query:
      - title="YSoft SafeQ"
      - title="SafeQ&reg;"
      - icon_hash="-608698287"
      - icon_hash="93381563"
    zoomeye-query:
      - title:"YSoft SafeQ"
      - title:"SafeQ"
  tags: panel,ysoft,safeq,exposure,misconfig

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/login"

    stop-at-first-match: true
    host-redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "YSoft SafeQ"
          - "Y Soft Corporation, a.s."
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - 'YSoft (?:SafeQ|Framework) v?([0-9\.]+)'
        name: version