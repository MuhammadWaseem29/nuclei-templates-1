id: exposed-venv-dir

info:
  name: Exposed Python Virtual Environment Directory
  author: albaradijoy
  severity: info
  description: |
    Detects publicly accessible /venv directories, which may expose the Python virtual environment. These folders typically contain package dependencies and config files like pyvenv.cfg.
  impact: |
    Exposed virtual environment directories can reveal sensitive information about the application dependencies, versions, and configuration.
  remediation: |
    Restrict access to virtual environment directories by configuring proper web server rules or moving them outside the web root.
  reference:
    - https://docs.python.org/3/library/venv.html
  metadata:
    verified: true
    max-request: 1
  tags: exposure,venv,file-disclosure,python

http:
  - method: GET
    path:
      - "{{BaseURL}}/venv/"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) NucleiScanner

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "Index of /venv"

      - type: word
        part: header
        words:
          - "text/html"
